{
  "openapi": "3.0.0",
  "info": {
    "title": "KoolKatsAPI",
    "version": "1.0",
    "contact": {
      "name": "Peri Telemachou",
      "email": "z5214738@ad.unsw.edu.au"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000"
    }
  ],
  "paths": {
    "/disease": {
      "parameters": [],
      "get": {
        "summary": "Get disease breakdown in date range",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "diseases": {
                      "type": "object",
                      "properties": {
                        "diseaseInfo": {
                          "$ref": "#/components/schemas/Occurrences"
                        },
                        "articlesFound": {
                          "type": "integer"
                        }
                      }
                    },
                    "totalArticles": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        },
        "operationId": "get-disease-info",
        "description": "Get the number of cases of a disease within a date range",
        "parameters": [
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          },
          {
            "$ref": "#/components/parameters/keyTerms"
          },
          {
            "$ref": "#/components/parameters/location"
          }
        ]
      }
    },
    "/occurrences": {
      "parameters": [],
      "get": {
        "summary": "Get Occurrences of disease breakdown by location",
        "operationId": "get-occurrences-by-location",
        "description": "Get the number of occurences of different diseases/key terms by location/country",
        "parameters": [
          {
            "$ref": "#/components/parameters/keyTerms"
          },
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "locations": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Occurrences"
                      }
                    },
                    "debugInfo": {
                      "$ref": "#/components/schemas/DebugInfo"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/articles": {
      "get": {
        "summary": "Get articles matching search",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {},
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "articles": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Article"
                      }
                    },
                    "team": {
                      "$ref": "#/components/schemas/DebugInfo"
                    }
                  }
                },
                "examples": {
                  "Example": {
                    "value": {
                      "articles": [
                        {
                          "headline": "Coronavirus Spreading in Sydney",
                          "url": "https://epiwatch.com/five-new-cases-discovered-in-sydney",
                          "location": {
                            "country": "Australia",
                            "location": "Sydney"
                          },
                          "reports": [
                            {
                              "diseases": [
                                "Coronavirus"
                              ],
                              "syndromes": [],
                              "event_date": "2019-03-10 xx:xx:xx",
                              "locations": [
                                {
                                  "country": "Austrlia",
                                  "location": "Sydney"
                                }
                              ]
                            }
                          ],
                          "termsFound": [
                            "Coronavirus",
                            "Pandemic"
                          ],
                          "main_text": "Five new case of the Coronavirus have been discovered in Balmain...",
                          "date_of_publication": "2019-03-10 10:10:10"
                        }
                      ],
                      "team": {
                        "name": "KoolKats",
                        "accessTime": 133,
                        "serviceTime": 150
                      }
                    }
                  }
                }
              }
            }
          },
          "204": {
            "description": "No Content"
          },
          "400": {
            "description": "Bad Request"
          },
          "404": {
            "description": "Not Found"
          },
          "500": {
            "description": "Internal Server Error"
          },
          "503": {
            "description": "Service Unavailable"
          }
        },
        "operationId": "get-getArticles",
        "description": "Gets all articles from scraped World Health Organisation (WHO) source filtered by date range, location and key terms.",
        "parameters": [
          {
            "$ref": "#/components/parameters/keyTerms"
          },
          {
            "$ref": "#/components/parameters/location"
          },
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "keyTerms": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "location": {
                    "type": "string"
                  },
                  "startDate": {
                    "$ref": "#/components/schemas/DateExact"
                  },
                  "endDate": {
                    "$ref": "#/components/schemas/DateExact"
                  }
                }
              }
            }
          },
          "description": "This is the result\n"
        }
      },
      "parameters": []
    },
    "/popularDiseases": {
      "get": {
        "summary": "Get popular diseases in date range",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "rankings": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Occurrences"
                      }
                    },
                    "debugInfo": {
                      "$ref": "#/components/schemas/DebugInfo"
                    }
                  }
                }
              }
            }
          }
        },
        "operationId": "get-popular-diseases",
        "description": "Get a ranking of diseases mentioned based on popularity",
        "parameters": [
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          },
          {
            "$ref": "#/components/parameters/location"
          }
        ]
      },
      "parameters": []
    }
  },
  "components": {
    "schemas": {
      "Article": {
        "title": "Article",
        "type": "object",
        "description": "Information on an article including headline, url and main text",
        "x-examples": {
          "Example": {
            "title": "First COVID Case in Sydney",
            "url": "https://fakenews.com.au/first-covid-case-sydney",
            "location": "Sydney",
            "startDate": "user@example.com",
            "endDate": "1997-10-31",
            "cases": 0
          }
        },
        "properties": {
          "headline": {
            "description": "",
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "location": {
            "$ref": "#/components/schemas/Location"
          },
          "reports": {
            "type": "array",
            "description": "",
            "items": {
              "$ref": "#/components/schemas/Report"
            }
          },
          "termsFound": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "main_text": {
            "type": "string"
          },
          "date_of_publication": {
            "$ref": "#/components/schemas/Dates"
          }
        },
        "required": [
          "headline",
          "url",
          "location",
          "reports"
        ]
      },
      "UserInput": {
        "title": "UserInput",
        "type": "object",
        "x-examples": {
          "SydneyRequest": {
            "startDate": "2019-01-11T09:02:00",
            "endDate": "2019-01-16T11:02:10",
            "keyTerms": "anthrax,zika",
            "location": "Sydney"
          }
        },
        "properties": {
          "startDate": {
            "type": "string",
            "example": "YYYY-MM-DDtHH:MM:SS"
          },
          "endDate": {
            "type": "string",
            "example": "YYYY-MM-DDtHH:MM:SS"
          },
          "keyTerms": {
            "type": "string"
          },
          "location": {
            "type": "string"
          }
        },
        "required": [
          "startDate",
          "endDate",
          "keyTerms",
          "location"
        ],
        "description": "Data the user can input"
      },
      "Report": {
        "title": "Report",
        "type": "object",
        "x-examples": {
          "Example": {
            "diseases": [
              "COVID",
              "Malaria"
            ],
            "syndromes": [],
            "event_date": "2019-05-05 11:22:01",
            "locations": [
              "Sydney",
              "Melbourne",
              "Perth"
            ]
          }
        },
        "properties": {
          "diseases": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Disease"
            }
          },
          "syndromes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Syndrome"
            }
          },
          "event_date": {
            "$ref": "#/components/schemas/Dates"
          },
          "locations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Location"
            }
          }
        },
        "required": [
          "event_date"
        ],
        "description": "One case of disease"
      },
      "Dates": {
        "title": "Dates",
        "oneOf": [
          {
            "$ref": "#/components/schemas/DateExact"
          },
          {
            "$ref": "#/components/schemas/DateRange"
          }
        ],
        "description": "Either in the form of a single date or a range"
      },
      "DateRange": {
        "type": "string",
        "title": "DateRange",
        "pattern": "^(\\d{4})-(\\d\\d|xx)-(\\d\\d|xx) (\\d\\d|xx):(\\d\\d|xx):(\\d\\d|xx) to (\\d{4})-(\\d\\d|xx)-(\\d\\d|xx) (\\d\\d|xx):(\\d\\d|xx):(\\d\\d|xx)$",
        "description": "Date range"
      },
      "DateExact": {
        "type": "string",
        "title": "DateExact",
        "x-examples": {
          "example-1": "string"
        },
        "pattern": "^(\\d{4})-(\\d\\d|xx)-(\\d\\d|xx) (\\d\\d|xx):(\\d\\d|xx):(\\d\\d|xx)$",
        "description": "Single date"
      },
      "Disease": {
        "title": "Disease",
        "type": "string",
        "description": "Disease name"
      },
      "Syndrome": {
        "title": "Syndrome",
        "type": "string",
        "description": "Syndrome name"
      },
      "Location": {
        "title": "Location",
        "type": "object",
        "properties": {
          "country": {
            "type": "string"
          },
          "location": {
            "type": "string"
          }
        },
        "description": "Country and location name e.g. state/city"
      },
      "EventType": {
        "title": "EventType",
        "type": "string",
        "description": "'presence', 'death', 'infected', 'hospitalised', 'recovered'"
      },
      "DebugInfo": {
        "title": "DebugInfo",
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "accessTime": {
            "type": "integer"
          },
          "serviceTime": {
            "type": "integer"
          }
        },
        "description": "Additional information"
      },
      "Occurrences": {
        "title": "Occurrences",
        "type": "object",
        "description": "Name of disease/location and occurence of disease",
        "properties": {
          "name": {
            "type": "string"
          },
          "occurrences": {
            "type": "integer"
          }
        }
      }
    },
    "responses": {
      "ArticleList": {
        "description": "List of articles",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "articles": {
                  "$ref": "#/components/schemas/Article"
                },
                "debugInfo": {
                  "$ref": "#/components/schemas/DebugInfo"
                }
              },
              "required": [
                "articles"
              ]
            }
          }
        }
      }
    },
    "parameters": {
      "startDate": {
        "name": "startDate",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "The desired starting date to fetch articles for in the form 'YYYY-MM-DD HH:MM:SS'"
      },
      "location": {
        "name": "location",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "The city or country of interest"
      },
      "keyTerms": {
        "name": "keyTerms",
        "in": "query",
        "required": true,
        "schema": {
          "type": "array"
        },
        "description": "Words to filter the search"
      },
      "endDate": {
        "name": "endDate",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "The desired end date to fetch articles for in the form 'YYYY-MM-DD HH:MM:SS'"
      }
    }
  }
}