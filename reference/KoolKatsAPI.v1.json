{
  "openapi": "3.0.0",
  "info": {
    "title": "KoolKatsAPI",
    "version": "1.0",
    "contact": {
      "name": "Peri Telemachou",
      "email": "z5214738@ad.unsw.edu.au"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000"
    }
  ],
  "paths": {
    "/disease": {
      "parameters": [],
      "get": {
        "summary": "Get disease breakdown in date range",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "diseases": {
                      "type": "object",
                      "properties": {
                        "diseaseInfo": {
                          "$ref": "#/components/schemas/Occurrences"
                        },
                        "articlesFound": {
                          "type": "integer"
                        }
                      }
                    },
                    "totalArticles": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        },
        "operationId": "get-disease-info",
        "description": "Get the number of cases of a disease within a date range",
        "parameters": [
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          },
          {
            "$ref": "#/components/parameters/keyTerms"
          },
          {
            "$ref": "#/components/parameters/location"
          }
        ]
      }
    },
    "/occurrences": {
      "parameters": [],
      "get": {
        "summary": "Get Occurrences of disease breakdown by location",
        "operationId": "get-occurrences-by-location",
        "description": "Get the number of occurences of different diseases/key terms by location/country",
        "parameters": [
          {
            "$ref": "#/components/parameters/keyTerms"
          },
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "locations": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Occurrences"
                      }
                    },
                    "debugInfo": {
                      "$ref": "#/components/schemas/DebugInfo"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/articles": {
      "get": {
        "summary": "Get articles matching search",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "headers": {},
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "articles": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Article"
                      }
                    },
                    "team": {
                      "$ref": "#/components/schemas/DebugInfo"
                    }
                  }
                },
                "examples": {
                  "Example": {
                    "value": {
                      "articles": [
                        {
                          "headline": "Coronavirus Spreading in Sydney",
                          "url": "https://epiwatch.com/five-new-cases-discovered-in-sydney",
                          "location": {
                            "country": "Australia",
                            "location": "Sydney"
                          },
                          "reports": [
                            {
                              "diseases": [
                                "Coronavirus"
                              ],
                              "syndromes": [],
                              "event_date": "2019-03-10 xx:xx:xx",
                              "locations": [
                                {
                                  "country": "Austrlia",
                                  "location": "Sydney"
                                }
                              ]
                            }
                          ],
                          "termsFound": [
                            "Coronavirus",
                            "Pandemic"
                          ],
                          "main_text": "Five new case of the Coronavirus have been discovered in Balmain...",
                          "date_of_publication": "2019-03-10 10:10:10"
                        }
                      ],
                      "team": {
                        "name": "KoolKats",
                        "accessTime": 133,
                        "serviceTime": 150
                      }
                    }
                  }
                }
              }
            }
          },
          "204": {
            "description": "No Content"
          },
          "400": {
            "description": "Bad Request"
          },
          "404": {
            "description": "Not Found"
          },
          "500": {
            "description": "Internal Server Error"
          },
          "503": {
            "description": "Service Unavailable"
          }
        },
        "operationId": "get-getArticles",
        "description": "Gets all articles from scraped World Health Organisation (WHO) source filtered by date range, location and key terms.",
        "parameters": [
          {
            "$ref": "#/components/parameters/keyTerms"
          },
          {
            "$ref": "#/components/parameters/location"
          },
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "keyTerms": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "location": {
                    "type": "string"
                  },
                  "startDate": {
                    "$ref": "#/components/schemas/DateExact"
                  },
                  "endDate": {
                    "$ref": "#/components/schemas/DateExact"
                  }
                }
              }
            }
          },
          "description": "This is the result\n"
        }
      },
      "parameters": []
    },
    "/popularDiseases": {
      "get": {
        "summary": "Get popular diseases in date range",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "rankings": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Occurrences"
                      }
                    },
                    "debugInfo": {
                      "$ref": "#/components/schemas/DebugInfo"
                    }
                  }
                }
              }
            }
          }
        },
        "operationId": "get-popular-diseases",
        "description": "Get a ranking of diseases mentioned based on popularity",
        "parameters": [
          {
            "$ref": "#/components/parameters/startDate"
          },
          {
            "$ref": "#/components/parameters/endDate"
          },
          {
            "$ref": "#/components/parameters/location"
          }
        ]
      },
      "parameters": []
    }
  },
  "components": {
    "schemas": {
      "Article": {
        "title": "Article",
        "type": "object",
        "description": "Information on an article including headline, url and main text",
        "x-examples": {
          "Example": {
            "title": "First COVID Case in Sydney",
            "url": "https://fakenews.com.au/first-covid-case-sydney",
            "location": "Sydney",
            "startDate": "user@example.com",
            "endDate": "1997-10-31",
            "cases": 0
          },
          "example-2": {
            "headline": "Listeriosis - Australia",
            "url": "https://www.who.int/csr/don/09-april-2018-listeriosis-australia/en/",
            "location": {
              "country": "Australia",
              "location": "Australia"
            },
            "reports": [
              {
                "diseases": [
                  "Listeriosis"
                ],
                "syndromes": [],
                "event_date": "2018-04-06",
                "locations": [
                  {
                    "country": "Australia",
                    "location": "Australia"
                  }
                ]
              }
            ],
            "termsFound": [
              "Listeriosis"
            ],
            "main_text": "On 2 March 2018, the Australian National Focal Point (NFP) notified WHO of an outbreak of Listeria monocytogenes infection (listeriosis) associated with the consumption of rockmelons (cantaloupe) from a single grower. From 17 January 2018 through to 6 April 2018, 20 outbreak cases (19 confirmed and 1 probable) of listeriosis were reported. All of the cases were hospitalized and there have been seven deaths and one miscarriage associated with the outbreak. All of the outbreak cases have had illness onset since 17 January 2018. Public health response. Epidemiological investigations suggested that the source of the outbreak was rockmelon (cantaloupe melons) from a single grower in Australia. Epidemiological and environmental investigations were undertaken, which led to the recall of rockmelons produced by the single grower on 27 February 2018. On 1 March 2018, the Australian NFP was notified that international distribution of the affected product had occurred. Australian authorities received information from trace forward investigations on 2 March 2018 that the rockmelons from this grower were exported to eight countries; Hong Kong Special Administrative Region (China), Japan, Kuwait, Malaysia, Oman, Qatar, Singapore, and United Arab Emirates. The Australian NFP directly advised these countries on 3 March 2018 about the export of rockmelons from Australia to their country. In parallel, a notification via the International Food Safety Authorities Network (INFOSAN) was also sent on 3 March 2018.Further trace forward investigations on 7 March 2018 identified that Bahrain also received an export of the rockmelons from this grower and on 8 March 2018, investigations further identified that the affected rockmelons may have been included in a consignment to the Seychelles. The Australian NFP advised the Bahrain NFP directly on 8 March 2018 and the Seychelles NFP directly on 9 March 2018. As of 8 March, trace forward activities have been concluded.The INFOSAN emergency contact points in the importing countries were provided with specific distribution details of the rockmelons to their respective countries by the INFOSAN emergency contact point in Australia, as they became available. On 4 April 2018, it was reported that more than 30 samples of melons from the grower through the supply chain, including retail and on farm, tested positive to Listeria monocytogenes. Additional testing found L. monocytogenes in the packing area. All L. monocytogenes samples had the same genetic sequence as the human cases. It is believed that the cause of the outbreak was a combination of environmental conditions and weather contaminating the surface of the fruit, with low levels of the bacteria persisting after the washing process. The grower continues to work closely with the relevant authorities and has returned to supply rockmelons (during the week starting 2 April) after testing cleared the property. WHO risk assessment.The prompt epidemiological and environmental investigation carried out led to the identification of the outbreak source and enabled the issuing of a recall. Due to the potentially long incubation period of L. monocytogenes, further outbreak cases may be reported. Import details have been provided though INFOSAN to the affected countries to enable them to take appropriate management measures including local recalls and risk communication. Cases in the affected countries may still be identified.WHO advice. Pregnant women, the elderly and immunocompromised individuals should take precautions to avoid infection by Listeria by avoiding the consumption of high risk foods including dairy products made of unpasteurized milk, soft cheeses, deli meat products (ready-to eat meat cuts, pâté, etc.); ice creams, raw seafood, crustaceans, and shellfish. These are the most common foods associated with Listeria infection. In recent years, melon, and other fruits and vegetables have been implicated on rare occasions in outbreaks of listeriosis. To reduce the risk, it is important to thoroughly wash all fruits and vegetables. It is recommended that risk communication messages regarding listeriosis be targeted to at-risk groups, primarily pregnant women, older persons and people with weakened immune systems, for example people with cancer, HIV, diabetes, kidney or liver disease or those taking immunosuppressive medications. These messages should recommend avoiding the consumption of high-risk foods.",
            "date_of_publication": "2018-04-09"
          }
        },
        "properties": {
          "headline": {
            "description": "",
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "location": {
            "$ref": "#/components/schemas/Location"
          },
          "reports": {
            "type": "array",
            "description": "",
            "items": {
              "$ref": "#/components/schemas/Report"
            }
          },
          "termsFound": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "main_text": {
            "type": "string"
          },
          "date_of_publication": {
            "$ref": "#/components/schemas/Dates"
          }
        },
        "required": [
          "headline",
          "url",
          "location",
          "reports"
        ]
      },
      "UserInput": {
        "title": "UserInput",
        "type": "object",
        "x-examples": {
          "SydneyRequest": {
            "startDate": "2019-01-11T09:02:00",
            "endDate": "2019-01-16T11:02:10",
            "keyTerms": "anthrax,zika",
            "location": "Sydney"
          }
        },
        "properties": {
          "startDate": {
            "type": "string",
            "example": "YYYY-MM-DDtHH:MM:SS"
          },
          "endDate": {
            "type": "string",
            "example": "YYYY-MM-DDtHH:MM:SS"
          },
          "keyTerms": {
            "type": "string"
          },
          "location": {
            "type": "string"
          }
        },
        "required": [
          "startDate",
          "endDate",
          "keyTerms",
          "location"
        ],
        "description": "Data the user can input"
      },
      "Report": {
        "title": "Report",
        "type": "object",
        "x-examples": {
          "Example": {
            "diseases": [
              "COVID",
              "Malaria"
            ],
            "syndromes": [],
            "event_date": "2019-05-05 11:22:01",
            "locations": [
              "Sydney",
              "Melbourne",
              "Perth"
            ]
          }
        },
        "properties": {
          "diseases": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Disease"
            }
          },
          "syndromes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Syndrome"
            }
          },
          "event_date": {
            "$ref": "#/components/schemas/Dates"
          },
          "locations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Location"
            }
          }
        },
        "required": [
          "event_date"
        ],
        "description": "One case of diseases"
      },
      "Dates": {
        "title": "Dates",
        "oneOf": [
          {
            "$ref": "#/components/schemas/DateExact"
          },
          {
            "$ref": "#/components/schemas/DateRange"
          }
        ],
        "description": "Either in the form of a single date or a range"
      },
      "DateRange": {
        "type": "string",
        "title": "DateRange",
        "pattern": "^(\\d{4})-(\\d\\d|xx)-(\\d\\d|xx) (\\d\\d|xx):(\\d\\d|xx):(\\d\\d|xx) to (\\d{4})-(\\d\\d|xx)-(\\d\\d|xx) (\\d\\d|xx):(\\d\\d|xx):(\\d\\d|xx)$",
        "description": "Date range",
        "x-examples": {
          "Example of date range": "2015-10-01 08:45:10 to 2016-10-01 08:45:10"
        }
      },
      "DateExact": {
        "type": "string",
        "title": "DateExact",
        "x-examples": {
          "Example of single date": "2015-10-01 08:45:10"
        },
        "pattern": "^(\\d{4})-(\\d\\d|xx)-(\\d\\d|xx) (\\d\\d|xx):(\\d\\d|xx):(\\d\\d|xx)$",
        "description": "Single date"
      },
      "Disease": {
        "title": "Disease",
        "type": "string",
        "description": "Disease name",
        "x-examples": {
          "Coronavirus": "Coronavirus"
        }
      },
      "Syndrome": {
        "title": "Syndrome",
        "type": "string",
        "description": "Syndrome name"
      },
      "Location": {
        "title": "Location",
        "type": "object",
        "properties": {
          "country": {
            "type": "string"
          },
          "location": {
            "type": "string"
          }
        },
        "description": "Country and location name e.g. state/city",
        "x-examples": {
          "example-1": {
            "country": "Australia",
            "location": "Sydney"
          },
          "example-2": {
            "country": "Australia",
            "location": "New South Wales"
          }
        }
      },
      "EventType": {
        "title": "EventType",
        "type": "string",
        "description": "'presence', 'death', 'infected', 'hospitalised', 'recovered', ''",
        "x-examples": {
          "presence": "presence",
          "death": "death",
          "infected": "indected",
          "hospitalised": "hospitalised",
          "recovered": "recovered",
          "empty": ""
        }
      },
      "DebugInfo": {
        "title": "DebugInfo",
        "type": "object",
        "description": "Additional information",
        "properties": {
          "name": {
            "type": "string"
          },
          "accessTime": {
            "type": "integer"
          },
          "serviceTime": {
            "type": "integer"
          },
          "dataSource": {
            "type": "string",
            "default": "WHO",
            "readOnly": true
          }
        },
        "x-examples": {
          "example-1": {
            "name": "KoolKats",
            "accessTime": 0,
            "serviceTime": 0,
            "dataSource": "WHO"
          }
        }
      },
      "Occurrences": {
        "title": "Occurrences",
        "type": "object",
        "description": "Name of disease/location and occurence of disease",
        "properties": {
          "name": {
            "type": "string"
          },
          "occurrences": {
            "type": "integer"
          }
        }
      }
    },
    "responses": {
      "ArticleList": {
        "description": "List of articles",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "articles": {
                  "$ref": "#/components/schemas/Article"
                },
                "debugInfo": {
                  "$ref": "#/components/schemas/DebugInfo"
                }
              },
              "required": [
                "articles"
              ]
            }
          }
        }
      }
    },
    "parameters": {
      "startDate": {
        "name": "startDate",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "The desired starting date to fetch articles for in the form 'YYYY-MM-DD HH:MM:SS'"
      },
      "location": {
        "name": "location",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "The city or country of interest"
      },
      "keyTerms": {
        "name": "keyTerms",
        "in": "query",
        "required": true,
        "schema": {
          "type": "array"
        },
        "description": "Words to filter the search"
      },
      "endDate": {
        "name": "endDate",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string"
        },
        "description": "The desired end date to fetch articles for in the form 'YYYY-MM-DD HH:MM:SS'"
      }
    }
  }
}